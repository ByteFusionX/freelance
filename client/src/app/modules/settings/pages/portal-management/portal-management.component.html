<div class="w-full p-6">
    <div class="w-full h-full bg-white p-10 m-2 rounded-md" *ngIf="this.privileges?.portalManagement?.department">
        <div class="mb-3 flex justify-between">
            <div class="flex gap-1">
                <i><ng-icon name="heroBuildingLibrary" class="text-orange-400 text-lg mt-[1px]"></ng-icon></i>
                <p class="font-medium text-orange-400">Department:</p>
            </div>
            <button class="bg-violet-700 px-3 py-2 text-white hover:bg-violet-600 rounded-md text-sm"
                (click)="onCreateDepartment()" *ngIf="!openCreateForm">+ Add
                Department</button>
        </div>
        <div>
            <div class="h-full h-max-80 overflow-hidden overflow-y-auto example border">
                <table mat-table [dataSource]="departmentDataSource" class="rounded-lg table-fixed">
                    <!-- Position Column -->
                    <ng-container matColumnDef="position">
                        <th *matHeaderCellDef
                            class="bg-gray-100 px-[20px] py-[16px] text-start text-dark  text-[15px] font-medium border-none before:hidden">
                            No </th>
                        <td mat-cell *matCellDef="let element; let i=index"> {{i+1}} </td>
                    </ng-container>

                    <!-- Name Column -->
                    <ng-container matColumnDef="name">
                        <th *matHeaderCellDef
                            class="bg-gray-100  px-[20px] py-[16px] text-start text-dark  text-[15px] font-medium border-none before:hidden">
                            Name </th>
                        <td mat-cell *matCellDef="let element"> {{element.departmentName}} </td>
                    </ng-container>

                    <!-- head Column -->
                    <ng-container matColumnDef="head">
                        <th *matHeaderCellDef
                            class="bg-gray-100  px-[20px] py-[16px] text-start text-dark  text-[15px] font-medium border-none before:hidden">
                            Head </th>
                        <td mat-cell *matCellDef="let element"> {{element.departmentHead[0].firstName}}
                            {{element.departmentHead[0].lastName}}</td>
                    </ng-container>

                    <!-- date Column -->
                    <ng-container matColumnDef="date">
                        <th *matHeaderCellDef
                            class="bg-gray-100  px-[20px] py-[16px] text-start text-dark  text-[15px] font-medium border-none before:hidden">
                            Created Date </th>
                        <td mat-cell *matCellDef="let element"> {{element.createdDate | date: 'dd/MM/yyyy'}} </td>
                    </ng-container>

                    <!-- action Column -->
                    <ng-container matColumnDef="action">
                        <th *matHeaderCellDef
                            class="bg-gray-100  px-[20px] py-[16px] text-start text-dark  text-[15px] font-medium border-none before:hidden">
                            Action </th>
                        <td mat-cell *matCellDef="let element; let i=index">
                            <ng-icon class=" cursor-pointer hover:text-purple-600" name="heroPencilSquare"
                                (click)="onEditClick(i)"></ng-icon>
                        </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="departmentDisplayedColumns; sticky: true"></tr>
                    <tr mat-row *matRowDef="let row; columns: departmentDisplayedColumns;"></tr>
                </table>
                <app-skelton-loading *ngIf="isDepartmentLoading" [lineLength]="2"></app-skelton-loading>
            </div>
        </div>
    </div>
    <div class="w-full h-full bg-white p-10 m-2 rounded-md" *ngIf="this.privileges?.portalManagement?.department">
        <div class="mb-3 flex justify-between">
            <div class="flex gap-1">
                <i><ng-icon name="heroBuildingLibrary" class="text-orange-400 text-lg mt-[1px]"></ng-icon></i>
                <p class="font-medium text-orange-400">Customer Departments:</p>
            </div>
            <button class="bg-violet-700 px-3 py-2 text-white hover:bg-violet-600 rounded-md text-sm"
                (click)="onCreateCustomerDepartment()" *ngIf="!openCreateForm">+ Add
                Customer Department</button>
        </div>
        <div>
            <div class="h-full h-max-80 overflow-hidden overflow-y-auto example border">
                <table mat-table [dataSource]="customerDepartmentDataSource" class="rounded-lg table-fixed">
                    <!-- Position Column -->
                    <ng-container matColumnDef="position">
                        <th *matHeaderCellDef
                            class="bg-gray-100 px-[20px] py-[16px] text-start text-dark  text-[15px] font-medium border-none before:hidden">
                            No </th>
                        <td mat-cell *matCellDef="let element; let i=index"> {{i+1}} </td>
                    </ng-container>

                    <!-- Name Column -->
                    <ng-container matColumnDef="name">
                        <th *matHeaderCellDef
                            class="bg-gray-100  px-[20px] py-[16px] text-start text-dark  text-[15px] font-medium border-none before:hidden">
                            Name </th>
                        <td mat-cell *matCellDef="let element"> {{element.departmentName}} </td>
                    </ng-container>

                    <!-- date Column -->
                    <ng-container matColumnDef="date">
                        <th *matHeaderCellDef
                            class="bg-gray-100  px-[20px] py-[16px] text-start text-dark  text-[15px] font-medium border-none before:hidden">
                            Created Date </th>
                        <td mat-cell *matCellDef="let element"> {{element.createdDate | date: 'dd/MM/yyyy'}} </td>
                    </ng-container>


                    <tr mat-header-row *matHeaderRowDef="customerDepartmentDisplayedColumns; sticky: true"></tr>
                    <tr mat-row *matRowDef="let row; columns: customerDepartmentDisplayedColumns;"></tr>
                </table>
                <app-skelton-loading *ngIf="isCustomerDepartmentLoading" [lineLength]="2"></app-skelton-loading>
            </div>
        </div>
    </div>

    <div class="w-full h-full bg-white p-10 m-2 rounded-md" *ngIf="this.privileges?.portalManagement?.notesAndTerms">
        <div class="mb-3 flex justify-between">
            <div class="flex gap-1">
                <i><ng-icon name="heroDocumentText" class="text-orange-400 text-lg mt-[1px]"></ng-icon></i>
                <p class="font-medium text-orange-400">Customer Note & Terms:</p>
            </div>
        </div>
        <div>
            <div class="h-full h-max-80 overflow-hidden overflow-y-auto example border">
                <table mat-table [dataSource]="cstcDataSource" class="rounded-lg table-fixed min-w-full">

                    <!-- CustomerNote Column -->
                    <ng-container matColumnDef="customerNote">
                        <th *matHeaderCellDef
                            class="bg-gray-100  px-[20px] py-[16px] text-start text-dark  text-[15px] font-medium border-none before:hidden w-2/5">
                            Customer Notes </th>
                        <td mat-cell *matCellDef="let element" class="align-top w-2/5">
                            <div *ngFor="let note of element.customerNotes">
                                <div class="flex justify-between items-center px-2 py-4 ">
                                    <p class="whitespace-pre-line">{{note.note}}</p>
                                    <div class="flex gap-2">
                                        <ng-icon (click)="onNoteForm('editCustomerNote',note.note,note._id)"
                                            class=" cursor-pointer hover:text-purple-600"
                                            name="heroPencilSquare"></ng-icon>
                                        <ng-icon (click)="onNoteDelete('customerNotes',note._id)"
                                            class=" cursor-pointer text-red-600 hover:text-red-900"
                                            name="heroTrash"></ng-icon>
                                    </div>
                                </div>
                                <hr>
                            </div>
                            <button (click)="onNoteForm('createCustomerNote')"
                                class="my-4  mt-4 bg-violet-700 px-3 py-2 text-white hover:bg-violet-600 rounded-md text-sm">+
                                Create Customer Note</button>
                        </td>
                    </ng-container>

                    <!-- Terms&Conditon Column -->
                    <ng-container matColumnDef="termsCondition">
                        <th *matHeaderCellDef
                            class="bg-gray-100  px-[20px] py-[16px] text-start text-dark  text-[15px] font-medium border-none before:hidden w-3/5">
                            Terms & Conditons </th>
                        <td mat-cell *matCellDef="let element" class="align-top w-3/5">
                            <div *ngFor="let note of element.termsAndConditions">
                                <div class="flex justify-between items-center px-2">
                                    <p class="py-4  whitespace-pre-line">{{note.note}}</p>
                                    <div class="flex gap-2">
                                        <ng-icon (click)="onNoteForm('editTermsAndCondition',note.note,note._id)"
                                            class=" cursor-pointer hover:text-purple-600"
                                            name="heroPencilSquare"></ng-icon>
                                        <ng-icon (click)="onNoteDelete('termsAndConditions',note._id)"
                                            class=" cursor-pointer text-red-600 hover:text-red-900"
                                            name="heroTrash"></ng-icon>
                                    </div>
                                </div>
                                <hr>
                            </div>
                            <button (click)="onNoteForm('createTermsAndCondition')"
                                class="my-4 mt-4 bg-violet-700 px-3 py-2 text-white hover:bg-violet-600 rounded-md text-sm">+
                                Create Terms & Conditons</button>
                        </td>
                    </ng-container>


                    <tr mat-header-row *matHeaderRowDef="cstcDisplayedColumns; sticky: true"></tr>
                    <tr mat-row *matRowDef="let row; columns: cstcDisplayedColumns;"></tr>
                </table>
                <app-skelton-loading *ngIf="isNotesLoading" [lineLength]="2"></app-skelton-loading>
            </div>
        </div>
    </div>

    <div class="w-full h-full bg-white p-10 m-2 rounded-md" *ngIf="categorySection">
        <div class="mb-3 flex justify-between">
            <div class="flex gap-1">
                <i><ng-icon name="heroTag" class="text-orange-400 text-lg mt-[1px]"></ng-icon></i>
                <p class="font-medium text-orange-400">Categories:</p>
            </div>
            <button class="bg-violet-700 px-3 py-2 text-white hover:bg-violet-600 rounded-md text-sm"
                (click)="createCategory()" *ngIf="!openCreateForm">+ Create
                Category</button>
        </div>
        <div>
            <div class="h-full h-max-80 overflow-hidden overflow-y-auto example border">
                <table mat-table [dataSource]="categoryDataSource" class="rounded-lg table-fixed">
                    <!-- slNo Column -->
                    <ng-container matColumnDef="slNo">
                        <th *matHeaderCellDef
                            class="bg-gray-100 px-[20px] py-[16px] text-start text-dark  text-[15px] font-medium border-none before:hidden">
                            No </th>
                        <td mat-cell *matCellDef="let element; let i=index"> {{i+1}} </td>
                    </ng-container>

                    <!-- categoryName Column -->
                    <ng-container matColumnDef="categoryName">
                        <th *matHeaderCellDef
                            class="bg-gray-100  px-[20px] py-[16px] text-start text-dark  text-[15px] font-medium border-none before:hidden">
                            Category Name </th>
                        <td mat-cell *matCellDef="let element"> {{element.categoryName}} </td>
                    </ng-container>

                    <!-- Role Column -->
                    <ng-container matColumnDef="role">
                        <th *matHeaderCellDef
                            class="bg-gray-100  px-[20px] py-[16px] text-start text-dark  text-[15px] font-medium border-none before:hidden">
                            Role </th>
                        <td mat-cell *matCellDef="let element">
                            {{element.role | titlecase}}</td>
                    </ng-container>

                    <!-- Count Column -->
                    <ng-container matColumnDef="count">
                        <th *matHeaderCellDef
                            class="bg-gray-100  px-[20px] py-[16px] text-center text-dark  text-[15px] font-medium border-none before:hidden">
                            No. of Employees </th>
                        <td mat-cell *matCellDef="let element">
                            <p class="text-center"> {{element.employeeCount}}</p>
                        </td>
                    </ng-container>

                    <!-- action Column -->
                    <ng-container matColumnDef="action">
                        <th *matHeaderCellDef
                            class="bg-gray-100  px-[20px] py-[16px] text-start text-dark  text-[15px] font-medium border-none before:hidden">
                            Action </th>
                        <td mat-cell *matCellDef="let element; let i=index">
                            <ng-icon *ngIf="i != 0" class=" cursor-pointer hover:text-purple-600"
                                name="heroPencilSquare" (click)="editCategory(element,i)"></ng-icon>
                        </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="categoryDisplayedColumns; sticky: true"></tr>
                    <tr mat-row *matRowDef="let row; columns: categoryDisplayedColumns;"></tr>
                </table>
                <app-skelton-loading *ngIf="isCategoryLoading" [lineLength]="2"></app-skelton-loading>
            </div>
        </div>
    </div>

</div>